#!/usr/bin/env bash
# Usage: bin/ai_exec <base-command> [args...]
# Chooses provider by policy, then retrieves a key via Token Steward, then runs.
set -euo pipefail
if [ $# -lt 1 ]; then
  echo "usage: $0 <base-command> [args...]" >&2
  exit 2
fi
PROVIDER="$(python3 tokens/provider_router.py)"
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
"$SCRIPT_DIR/run_with_token.sh" "$PROVIDER" "$@"